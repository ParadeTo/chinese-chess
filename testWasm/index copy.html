<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script src="/testWasm/wasm_exec.js"></script>
    <script src="./wasm_exec.js"></script>
    <script>
      function sumJS(n) {
        let s = 0
        for (let index = 0; index < n; index++) {
          s += 1
        }
        return s
      }
    </script>
    <script>
      const go = new Go()
      // WebAssembly.instantiateStreaming(
      //   fetch('http://127.0.0.1:8080/server/main.wasm'),
      //   go.importObject
      // ).then((result) => {
      //   go.run(result.instance)
      //   const board = `{"color":"b","pieces":[{"key":"rj1","color":"r","role":"j","pos":[0,9],"selected":false,"side":"b"},{"key":"rm1","color":"r","role":"m","pos":[1,9],"selected":false,"side":"b"},{"key":"rx1","color":"r","role":"x","pos":[2,9],"selected":false,"side":"b"},{"key":"rs1","color":"r","role":"s","pos":[3,9],"selected":false,"side":"b","possiblePos":{"t":[[3,0],[5,0],[4,1],[3,2],[5,2]],"b":[[3,9],[5,9],[4,8],[3,7],[5,7]]}},{"key":"rb","color":"r","role":"b","pos":[4,9],"selected":false,"side":"b"},{"key":"rs2","color":"r","role":"s","pos":[5,9],"selected":false,"side":"b","possiblePos":{"t":[[3,0],[5,0],[4,1],[3,2],[5,2]],"b":[[3,9],[5,9],[4,8],[3,7],[5,7]]}},{"key":"rx2","color":"r","role":"x","pos":[4,7],"selected":true,"side":"b"},{"key":"rm2","color":"r","role":"m","pos":[7,9],"selected":false,"side":"b"},{"key":"rj2","color":"r","role":"j","pos":[8,9],"selected":false,"side":"b"},{"key":"rp1","color":"r","role":"p","pos":[1,7],"selected":false,"side":"b"},{"key":"rp2","color":"r","role":"p","pos":[7,7],"selected":false,"side":"b"},{"key":"rz1","color":"r","role":"z","pos":[0,6],"selected":false,"side":"b"},{"key":"rz2","color":"r","role":"z","pos":[2,6],"selected":false,"side":"b"},{"key":"rz3","color":"r","role":"z","pos":[4,6],"selected":false,"side":"b"},{"key":"rz4","color":"r","role":"z","pos":[6,6],"selected":false,"side":"b"},{"key":"rz5","color":"r","role":"z","pos":[8,6],"selected":false,"side":"b"},{"key":"bj1","color":"b","role":"j","pos":[0,0],"selected":false,"side":"t"},{"key":"bm1","color":"b","role":"m","pos":[1,0],"selected":false,"side":"t"},{"key":"bx1","color":"b","role":"x","pos":[2,0],"selected":false,"side":"t"},{"key":"bs1","color":"b","role":"s","pos":[3,0],"selected":false,"side":"t","possiblePos":{"t":[[3,0],[5,0],[4,1],[3,2],[5,2]],"b":[[3,9],[5,9],[4,8],[3,7],[5,7]]}},{"key":"bb","color":"b","role":"b","pos":[4,0],"selected":false,"side":"t"},{"key":"bs2","color":"b","role":"s","pos":[5,0],"selected":false,"side":"t","possiblePos":{"t":[[3,0],[5,0],[4,1],[3,2],[5,2]],"b":[[3,9],[5,9],[4,8],[3,7],[5,7]]}},{"key":"bx2","color":"b","role":"x","pos":[6,0],"selected":false,"side":"t"},{"key":"bm2","color":"b","role":"m","pos":[7,0],"selected":false,"side":"t"},{"key":"bj2","color":"b","role":"j","pos":[8,0],"selected":false,"side":"t"},{"key":"bp1","color":"b","role":"p","pos":[1,2],"selected":false,"side":"t"},{"key":"bp2","color":"b","role":"p","pos":[7,2],"selected":false,"side":"t"},{"key":"bz1","color":"b","role":"z","pos":[0,3],"selected":false,"side":"t"},{"key":"bz2","color":"b","role":"z","pos":[2,3],"selected":false,"side":"t"},{"key":"bz3","color":"b","role":"z","pos":[4,3],"selected":false,"side":"t"},{"key":"bz4","color":"b","role":"z","pos":[6,3],"selected":false,"side":"t"},{"key":"bz5","color":"b","role":"z","pos":[8,3],"selected":false,"side":"t"}]}`
      //   window.wGetNextMove(board)
      // })
      fillmem()
      debugger
      WebAssembly.instantiateStreaming(
        fetch('http://127.0.0.1:8080/testWasm/main.wasm'),
        go.importObject
      ).then((result) => {
        go.run(result.instance)
        const n = 100000000
        let s = Date.now()
        console.log(window.sum1(n))
        console.log(Date.now() - s)
        s = Date.now()
        console.log(window.sum2(n))
        console.log(Date.now() - s)
        s = Date.now()
        console.log(sumJS(n))
        console.log(Date.now() - s)
      })
    </script>
  </body>
</html>
